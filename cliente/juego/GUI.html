<div id="passCode"></div>
<div id="chat" class="fixed bottom-0 left-0 w-[450px] p-4 bg-black bg-opacity-40 hidden">
    <div id="chatMessages" class="h-72 mb-4 overflow-auto flex flex-col pointer-events-auto animate__animated">
        <!-- Mensajes irán aquí -->
    </div>

    <div id="chatInput"
        class="rounded-full px-1 flex items-center pointer-events-auto cursor-pointer border border-white">
        <input id="chatInputText" type="text"
            class="flex-1 text-white px-2 py-1  rounded-full bg-transparent border-white outline-none">
        <button id="sendMessageButton" class="px-2 py-2 text-white focus:outline-none rounded-md">
            <i class="fas fa-paper-plane hover:text-blue-500"></i>
        </button>
    </div>

</div>

<style>
    #chatMessages::-webkit-scrollbar {
        width: 6px;
        /* Ancho de la barra de desplazamiento */
    }

    #chatMessages::-webkit-scrollbar-thumb {
        background-color: #f7f7f7;
        /* Color del pulgar de la barra de desplazamiento */
        border-radius: 8px;
        /* Radio de la esquina del pulgar */
    }
</style>




<script>
    const chatPadre = document.getElementById('chat');

    document.getElementById('sendMessageButton').addEventListener('click', function () {
        const messageText = document.getElementById('chatInputText').value;

        if (messageText.trim() !== '') {
            const newMessage = document.createElement('div');
            newMessage.textContent = `${$.cookie("nick")}: ${messageText}`;
            newMessage.classList.add('text-white', 'p-2', 'rounded-md', 'mb-2', 'mr-2');
            newMessage.style.wordWrap = 'break-word';  // Permite que el texto se rompa y ajuste en varias líneas

            document.getElementById('chatMessages').appendChild(newMessage);

            // Scroll hacia abajo para enfocar el último mensaje
            chatMessagesContainer.scrollTop = chatMessagesContainer.scrollHeight;
            // Limpiar el campo de entrada después de enviar el mensaje
            document.getElementById('chatInputText').value = '';
        }
    });

    const chatMessagesContainer = document.getElementById('chatMessages');
    let timeoutId;

    //quiero detectar que el raton esté sobre el chat
    chatMessagesContainer.addEventListener('mouseenter', function () {
        clearTimeout(timeoutId);
    });

    chatMessagesContainer.addEventListener('mouseleave', function () {
        clearTimeout(timeoutId);

        timeoutId = setTimeout(() => {
            // chatMessagesContainer.classList.add('animate__fadeOut');

            setTimeout(() => {
                chatMessagesContainer.classList.add('hidden');
                // chatMessagesContainer.classList.remove('animate__fadeOut');
                chatPadre.classList.add('hidden');
            }, 1000);
        }, 5000);
    });

    document.getElementById('chatInputText').addEventListener('focus', function () {
        clearTimeout(timeoutId);
        // chatMessagesContainer.classList.remove('animate__fadeOut');
        chatMessagesContainer.classList.remove('hidden');

        chatMessagesContainer.scrollTop = chatMessagesContainer.scrollHeight;
    });

    document.getElementById('chatInputText').addEventListener('blur', function () {
        clearTimeout(timeoutId);

        timeoutId = setTimeout(() => {
            // chatMessagesContainer.classList.add('animate__fadeOut');

            setTimeout(() => {
                chatMessagesContainer.classList.add('hidden');
                // chatMessagesContainer.classList.remove('animate__fadeOut');
                chatPadre.classList.add('hidden');

            }, 1000);
        }, 5000);


    });

    document.addEventListener('keydown', function
        (event) {
        if (event.key === 't' || event.key === 'T') {
            event.preventDefault();
            chatPadre.classList.remove('hidden');
            chatMessagesContainer.classList.remove('hidden');
            document.getElementById('chatInputText').focus();
            
        }
    });

    // ...

    document.getElementById('chatInputText').addEventListener('keydown', function (event) {
        if (event.key === 'Enter') {
            event.preventDefault(); // Evitar que el Enter realice un salto de línea en el campo de entrada

            const messageText = this.value.trim();

            if (messageText !== '') {
                const newMessage = document.createElement('div');
                newMessage.textContent = `${$.cookie("nick")}: ${messageText}`;
                newMessage.classList.add('text-white', 'p-2', 'rounded-md', 'mb-2', 'mr-2');
                newMessage.style.wordWrap = 'break-word';

                document.getElementById('chatMessages').appendChild(newMessage);

                chatMessagesContainer.scrollTop = chatMessagesContainer.scrollHeight;
                document.getElementById('chatInputText').value = '';
            }
        }
    });

    // ...



</script>